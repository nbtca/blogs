(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{609:function(s,t,a){s.exports=a.p+"assets/img/signal-1.f1106095.png"},610:function(s,t,a){s.exports=a.p+"assets/img/signal-2.66b7a7f8.png"},611:function(s,t,a){s.exports=a.p+"assets/img/signal-3.4eeb0826.png"},612:function(s,t,a){s.exports=a.p+"assets/img/signal-4.9aa5bdea.png"},613:function(s,t,a){s.exports=a.p+"assets/img/signal-5.b2898d9a.png"},614:function(s,t){s.exports="data:image/png;base64,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"},615:function(s,t,a){s.exports=a.p+"assets/img/signal-7.98dab60e.png"},616:function(s,t,a){s.exports=a.p+"assets/img/signal-8.8dbfa33a.png"},617:function(s,t,a){s.exports=a.p+"assets/img/signal-9.0ce6b0f3.png"},618:function(s,t,a){s.exports=a.p+"assets/img/signal-10.927b0962.png"},619:function(s,t,a){s.exports=a.p+"assets/img/signal-11.f1567c4b.png"},620:function(s,t,a){s.exports=a.p+"assets/img/signal-12.ea275c07.png"},621:function(s,t,a){s.exports=a.p+"assets/img/signal-13.d5aaf523.png"},622:function(s,t,a){s.exports=a.p+"assets/img/signal-14.15b298a7.png"},623:function(s,t,a){s.exports=a.p+"assets/img/signal-15.dd5ef641.png"},624:function(s,t,a){s.exports=a.p+"assets/img/7cb86c73b9e73893e6b0e0433d476928.0d825c8b.png"},696:function(s,t,a){"use strict";a.r(t);var n=a(10),r=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"linux-信号"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux-信号"}},[s._v("#")]),s._v(" "),t("strong",[s._v("Linux 信号")])]),s._v(" "),t("p",[s._v("信号本质上是整数，用户模式下用来模拟硬件中断。")]),s._v(" "),t("ul",[t("li",[s._v("什么是硬件中断？先理解为硬件引发的中断。")]),s._v(" "),t("li",[s._v("什么是中断？简言之，就是让CPU停下当前干的事转而去处理新的情况。")]),s._v(" "),t("li",[s._v("信号是谁产生的？可以由硬件、内核和进程产生。")])]),s._v(" "),t("p",[s._v("例如在终端上用"),t("code",[s._v("Ctrl+C")]),s._v("，可以结束掉当前终端进程，本质上是发送SIGINT信号。")]),s._v(" "),t("p",[s._v("如下是一个实例程序，该程序循环打印数字。运行起来，看看"),t("code",[s._v("Ctrl+C")]),s._v("能不能中止它：")]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdio.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<unistd.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<signal.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdbool.h>")])]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("hand")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" val"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"val: %d\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("val"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Do you want to kill me? No way!\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("signal")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("SIGINT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("hand"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" n "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("true"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"n:%d\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br")])]),t("p",[s._v("如下所示，现在使用Ctrl+C是没办法中断这个程序的：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(609),alt:"signal-1"}})]),s._v(" "),t("p",[s._v("这里可以用man命令查看一下signal函数的帮助文档：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(610),alt:"signal-2"}})]),s._v(" "),t("p",[s._v("signal关联上了一个信号处理函数，来处理信号。")]),s._v(" "),t("p",[s._v("现在修改这个代码，添加一行打印当前进程号，然后打开两个终端，一个终端运行上面的程序，一个终端尝试"),t("code",[s._v("kill")]),s._v("命令来发送信号：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(611),alt:"signal-3"}})]),s._v(" "),t("p",[s._v("kill 要指定参数：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(612),alt:"signal-4"}})]),s._v(" "),t("p",[s._v("这是可行的，结果如上。")]),s._v(" "),t("p",[t("strong",[s._v("信号处理的过程")])]),s._v(" "),t("p",[s._v("进程A在运行，内核、硬件或者其他进程发送信号给进程A。进程A接收到信号后，直接做信号本身规定的对应处理或者做事先注册好的信号处理。如上面signal函数就是注册信号处理，hand函数替换了本身默认的信号处理。当然信号是可以屏蔽的，不作任何处理。")]),s._v(" "),t("p",[s._v("Linux有哪些信号类型：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(613),alt:"signal-5"}})]),s._v(" "),t("p",[s._v("Linux 信号有64个，分为不可靠信号(非实时，1-31，Unix提供)和可靠信号(32-64，后来扩充的)。又有系统自带的标准信号和用户自定义的信号。")]),s._v(" "),t("p",[s._v("介绍几个命令或函数：")]),s._v(" "),t("ul",[t("li",[s._v("信号注册："),t("code",[s._v("signal")]),s._v("、"),t("code",[s._v("sigaction;")])]),s._v(" "),t("li",[s._v("信号发送："),t("code",[s._v("kill")]),s._v("命令、"),t("code",[s._v("kill")]),s._v("函数、"),t("code",[s._v("sigqueue;")])]),s._v(" "),t("li",[s._v("信号屏蔽："),t("code",[s._v("sigprocmask")]),s._v(";")]),s._v(" "),t("li",[s._v("信号集："),t("code",[s._v("sigset_t")]),s._v(".")])]),s._v(" "),t("p",[s._v("下面写一个发送信号的程序：")]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdio.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<unistd.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<signal.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdlib.h>")])]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" argc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" argv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" pid "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("atoi")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("argv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" sig "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("atoi")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("argv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pid:%d  sig:%d\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("pid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("sig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("sig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("p",[t("img",{attrs:{src:a(614),alt:"signal-6"}})]),s._v(" "),t("p",[t("img",{attrs:{src:a(615),alt:"signal-7"}})]),s._v(" "),t("p",[s._v("成功发送了信号。")]),s._v(" "),t("p",[t("code",[s._v("sigaction")]),s._v("函数有所不同，功能更多：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(616),alt:"signal-8"}})]),s._v(" "),t("p",[s._v("这里用到了一个结构体：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(617),alt:"signal-9"}})]),s._v(" "),t("p",[s._v("结构体的第一个成员依然是原来的信号处理函数，第二个成员被称作高级信号处理函数，第三个成员用于信号屏蔽，剩下两个暂时还用不到。")]),s._v(" "),t("p",[s._v("这个函数不仅可以发信号、做信号处理，还可以接收信号的同时接收数据")]),s._v(" "),t("p",[s._v("下列代码使用了高级信号处理：")]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdio.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<unistd.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<signal.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdbool.h>")])]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 基本信号处理函数")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("hand")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"基本信号处理函数\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 高级信号处理函数")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("handler")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("siginfo_t")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" siginfo"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" arg"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"高级信号处理函数\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"n:%d msg:%d\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("siginfo"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("si_int"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("sigaction")]),s._v(" act "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("sigaction")]),s._v(" old_act "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    act"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sa_handler "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hand"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    act"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sa_sigaction "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" handler"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    act"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sa_flags "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" SA_SIGINFO"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 高级信号处理")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sigaction")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("act"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("old_act"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pid:%d\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getpid")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" n "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("true"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"n:%d\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br")])]),t("p",[s._v("同时还要实现高级的信号发送，采用"),t("code",[s._v("sigqueue")]),s._v("：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(618),alt:"signal-10"}})]),s._v(" "),t("p",[s._v("这里有个重要的联合体，用来存储数据和信号一起发送：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(619),alt:"signal-11"}})]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdio.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<unistd.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<signal.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdlib.h>")])]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" argc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" argv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("  \n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" pid "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("atoi")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("argv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" sig "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("atoi")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("argv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pid:%d  sig:%d\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("argv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("argv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("union")]),s._v(" sigval u"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    u"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sival_int "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12345678")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sigqueue")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("sig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("u"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("p",[s._v("运行结果如下：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(620),alt:""}})]),s._v(" "),t("p",[t("img",{attrs:{src:a(621),alt:"signal-13"}})]),s._v(" "),t("p",[s._v("可以看到程序接收到了信号和数据。")]),s._v(" "),t("p",[s._v("也试试发送其他数据，联合体中还有一个指针类型的成员。")]),s._v(" "),t("h2",{attrs:{id:"linux信号-续"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux信号-续"}},[s._v("#")]),s._v(" Linux信号(续)")]),s._v(" "),t("blockquote",[t("p",[s._v("参考网站: Github、《极客时间》")])]),s._v(" "),t("p",[s._v("现在从底层角度来观赏Linux信号机制。")]),s._v(" "),t("p",[s._v("首先看信号的具体作用：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(622),alt:"signal-14"}})]),s._v(" "),t("p",[t("img",{attrs:{src:a(623),alt:"signal-15"}})]),s._v(" "),t("p",[s._v("如上文所提，处理信号有3种方式：执行默认操作，捕获信号和忽略信号")]),s._v(" "),t("p",[s._v("设置信号处理有两种方式: signal和sigaction")]),s._v(" "),t("p",[s._v("signal将一个动作和信号关联，sigaction也是将一个动作和信号关联，但这个动作用一个结构体表示了，处理信号将更加细致")]),s._v(" "),t("p",[s._v("siganal不是系统调用，而是glibc封装的一个函数，实现如下：")]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("define")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro-name"}},[s._v("signal")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token expression"}},[s._v("__sysv_signal")])]),s._v("\n__sighandler_t\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("__sysv_signal")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" sig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" __sighandler_t handler"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("sigaction")]),s._v(" act"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" oact"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n  act"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sa_handler "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" handler"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("__sigemptyset")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("act"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sa_mask"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  act"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sa_flags "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" SA_ONESHOT "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" SA_NOMASK "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" SA_INTERRUPT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  act"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sa_flags "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),s._v("SA_RESTART"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("__sigaction")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("act"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("oact"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" SIG_ERR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" oact"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sa_handler"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("weak_alias")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__sysv_signal"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sysv_signal"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("p",[s._v("这里可以看到 sa_flags 设置了一个SA_ONESHOT，这意味着信号处理函数只作用一次，用完一次后就返回默认行为")]),s._v(" "),t("p",[s._v("同时设置了SA_NOMASK，通过 __sigemptyset，将 sa_mask 设置为空。这样的设置表示在这个信号处理函数执行过程中，如果再有其他信号，哪怕相同的信号到来的时候，这个信号处理函数会被中断。如果一个信号处理函数真的被其他信号中断，问题也不大，因为当处理完了其他的信号处理函数后，还会回来接着处理这个信号处理函数的，但是对于相同的信号就有点尴尬了。一般的思路应该是，当某一个信号的信号处理函数运行的时候，暂时屏蔽这个信号，屏蔽并不意味着信号一定丢失，而是暂存，这样能够做到信号处理函数对于相同的信号，处理完一个再处理下一个，这样信号处理函数的逻辑要简单得多。")]),s._v(" "),t("p",[s._v("还有一个设置就是设置了 SA_INTERRUPT，清除了 SA_RESTART。信号的到来时间是不可预期的，有可能程序正在调用某个漫长的系统调用的时候，突然到来一个信号，中断了这个系统调用，去执行信号处理函数。那么执行完后信号处理函数，系统调用怎么办？")]),s._v(" "),t("p",[s._v("时候有两种处理方法，一种就是 SA_INTERRUPT，也即系统调用被中断了，就不再重试这个系统调用了，而是直接返回一个 -EINTR 常量，告诉调用方，这个系统调用被信号中断了，调用方可以根据自己的逻辑，重新调用或者直接返回，这会使得代码非常复杂，在所有系统调用的返回值判断里面，都要特殊判断一下这个值。")]),s._v(" "),t("p",[s._v("另外一种处理方法是 SA_RESTART。这个时候系统调用会被自动重新启动，不需要调用方自己写代码。当然也可能存在问题，例如从终端读入一个字符，这个时候用户在终端输入一个'a'字符，在处理'a'字符的时候被信号中断了，等信号处理完毕，再次读入一个字符的时候，如果用户不再输入，就停在那里了，需要用户再次输入同一个字符。")]),s._v(" "),t("p",[s._v("可知signal函数是受到限制的，因此，建议使用 sigaction 函数，根据自己的需要定制参数。")]),s._v(" "),t("p",[s._v("下面是glibc中的实现：")]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("__sigaction")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" sig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("sigaction")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("act"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("sigaction")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("oact"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("__libc_sigaction")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" act"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" oact"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("__libc_sigaction")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" sig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("sigaction")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("act"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("sigaction")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("oact"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" result"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("kernel_sigaction")]),s._v(" kact"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" koact"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("act"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      kact"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k_sa_handler "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" act"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sa_handler"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("memcpy")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("kact"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sa_mask"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("act"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sa_mask"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sizeof")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("sigset_t")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      kact"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sa_flags "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" act"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sa_flags "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" SA_RESTORER"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n\n      kact"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sa_restorer "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("restore_rt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\n  result "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("INLINE_SYSCALL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("rt_sigaction"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                           sig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" act "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("kact "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                           oact "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("koact "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" _NSIG "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("oact "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" result "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      oact"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sa_handler "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" koact"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k_sa_handler"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("memcpy")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("oact"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sa_mask"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("koact"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sa_mask"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sizeof")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("sigset_t")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      oact"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sa_flags "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" koact"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sa_flags"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      oact"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sa_restorer "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" koact"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sa_restorer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" result"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br")])]),t("p",[s._v("内核代码注释表明，系统调用 signal 是为了兼容过去，系统调用 sigaction 也是为了兼容过去，连参数都变成了 struct compat_old_sigaction，所以说，我们的库函数虽然调用的是 sigaction，到了系统调用层，调用的可不是系统调用 sigaction，而是系统调用 rt_sigaction。")]),s._v(" "),t("p",[s._v("在 "),t("code",[s._v("rt_sigaction")]),s._v(" 里面，将用户态的 struct sigaction 结构，拷贝为内核态的 "),t("code",[s._v("k_sigaction")]),s._v("，然后调用 "),t("code",[s._v("do_sigaction")]),s._v("。")]),s._v(" "),t("p",[t("code",[s._v("do_sigaction")]),s._v(" 也很简单，进程内核的数据结构里，struct task_struct 里面有一个成员 sighand，里面有一个 action。")]),s._v(" "),t("p",[s._v("这是一个数组，下标是信号，内容就是信号处理函数，"),t("code",[s._v("do_sigaction")]),s._v(" 就是设置 sighand 里的信号处理函数。")]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("do_sigaction")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" sig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("k_sigaction")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("act"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("k_sigaction")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("oact"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("task_struct")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("p "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" current"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("k_sigaction")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("k"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("sigset_t")]),s._v(" mask"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n  k "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("p"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sighand"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("action"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sig"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("spin_lock_irq")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("p"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sighand"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("siglock"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("oact"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("oact "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("k"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("act"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sigdelsetmask")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("act"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sa"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sa_mask"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sigmask")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("SIGKILL"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sigmask")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("SIGSTOP"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("k "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("act"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("spin_unlock_irq")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("p"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sighand"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("siglock"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br")])]),t("p",[s._v("总结：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(624),alt:""}})])])}),[],!1,null,null,null);t.default=r.exports}}]);